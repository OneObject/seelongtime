<%@ page contentType="text/html;charset=UTF-8"%>
<%@ include file="/WEB-INF/include/taglibs_m.jsp"%>
<!DOCTYPE html>
<html>
<head>
<title>用户登录</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta http-equiv="Cache-Control" content="no-store" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="stylesheet" href="${basepath}/static/plugins/fonticon/css/font-awesome.min.css">
<link rel="stylesheet" href="${basepath}/static/plugins/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="${basepath}/static/plugins/bootstrap/css/bootstrap-theme.css">
<link rel="stylesheet" href="${basepath}/static/m/new.css">
<style type="text/css">
        html,body{
            background-color: #eaeaea;
        }
</style>
<script>
var basepath='${basepath}';
</script>
<script type="text/javascript" src="${basepath}/static/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="${basepath}/static/plugins/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="${basepath }/static/m/weixin.js"></script>

<script type="text/javascript">
document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
	WeixinJSBridge.call('hideToolbar');
});
//去掉右上角选项
document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
	WeixinJSBridge.call('hideOptionMenu');
});

</script>

</head>
<body>
<%@ include file="/WEB-INF/layouts/m/header.jsp"%>
    <div class="login">
        <div class="login-box">
            <header>
                用户登录
            </header>
            <section class="input-box">
            
            <form action="${basepath}/m/login.xhtml" method="post" id="loginForm">
                <div class="input-group">
                    <input name="username" class="form-control" placeholder="手机号/邮箱" id="username">
                    <span class="input-group-addon">
                        <i class="fa fa-user"></i>
                    </span>
                </div>
                <div class="input-group">
                    <input name="password" type="password" class="form-control" placeholder="密码" id="password">
                    <span class="input-group-addon">
                        <i class="fa fa-lock"></i>
                    </span>
                </div>
                <c:if test="${not empty loginForm and loginForm.code !='success'}">
                <div class="input-group" id="error">
                    <div class="alert alert-danger">
	                    <c:choose>
	                	<c:when test="${loginForm.code=='empty'}">请输入手机号/邮件和密码</c:when>
	                	<c:when test="${loginForm.code=='pwdfial'}">手机号/邮件或密码错误</c:when>
	                	<c:when test="${loginForm.code=='disable'}">手机号/邮件被禁用</c:when>
	                	<c:when test="${loginForm.code=='expire'}">账号已过期</c:when>
	                	<c:when test="${loginForm.code=='already_bind'}">账号已被绑定</c:when>
	                	</c:choose>
                    </div>
                </div>
                </c:if>
                <div class="input-group" onclick="submit()">
                    <span class="bind">登录</span>
                </div>
                <c:if test="${not empty tenantConfig && tenantConfig.openregister==true}">
                <div><a href="${basepath}/m/register.xhtml?domain=${tenantConfig.id}&openid=${openid}">注册账号</a></div>
                </c:if>
                &nbsp;
                <input type="hidden"  name="domain" value="${domain}"/>
                <input type="hidden" name="callback" value="${callback}"/>
             </form>
            </section>
        </div>
    </div>

<%@ include file="/WEB-INF/layouts/m/footer.jsp"%>
</body>
</html>
<script type="text/javascript">
        function submit(){
        	$("#error").hide();
            if($("#username").val() == "" ||$("#password").val() == ""){
                $("#error").show();
            }else{
                /*提交操作*/
                $("#loginForm").submit();
            }
        }
</script>
<%@ include file="/WEB-INF/include/analysis.jsp"%>